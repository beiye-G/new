[2023-08-29 08:57:29] ==========
Args:Namespace(arch='resnet50', batch_size=6, dataset='llcm', erasing_p=0.5, gpu='7', img_h=256, img_w=128, lambda_1=0.8, lambda_2=0.01, log_path='log/', lr=0.01, margin=0.3, mode='all', model_path='save_model/', num_pos=4, optim='sgd', resume='', save_epoch=20, seed=0, test_batch=4, test_only=False, trial=2, vis_log_path='log/vis_log/', workers=4)
==========[2023-08-29 08:57:29] 
[2023-08-29 08:57:30] ==> Loading data..[2023-08-29 08:57:30] 
[2023-08-29 08:58:36] Dataset llcm statistics:[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   ------------------------------[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   subset   | # ids | # images[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   ------------------------------[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   visible  |   713 |    16946[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   thermal  |   713 |    13975[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   ------------------------------[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   query    |   351 |     7166[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   gallery  |   351 |      484[2023-08-29 08:58:36] 
[2023-08-29 08:58:36]   ------------------------------[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] Data Loading Time:	 66.207[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] ==> Building model..[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] using stride: 16, and patch number is num_y16 * num_x8[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] using stride: 16, and patch number is num_y16 * num_x8[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] using drop_out rate is : 0.0[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] using attn_drop_out rate is : 0.0[2023-08-29 08:58:36] 
[2023-08-29 08:58:36] using drop_path rate is : 0.1[2023-08-29 08:58:36] 
[2023-08-29 08:58:38] Load 1 / 207 layers.[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] Load 2 / 207 layers.[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] Load 3 / 207 layers.[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] Resized position embedding from size:torch.Size([1, 197, 768]) to size: torch.Size([1, 129, 768]) with height:16 width: 8[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] 152[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] odict_keys(['cls_token', 'norm.bias', 'norm.weight', 'blocks.0.norm1.bias', 'blocks.0.norm1.weight', 'blocks.0.norm2.bias', 'blocks.0.norm2.weight', 'blocks.0.mlp.fc1.bias', 'blocks.0.mlp.fc1.weight', 'blocks.0.mlp.fc2.bias', 'blocks.0.mlp.fc2.weight', 'blocks.0.attn.proj.bias', 'blocks.0.attn.proj.weight', 'blocks.0.attn.qkv.bias', 'blocks.0.attn.qkv.weight', 'blocks.1.norm1.bias', 'blocks.1.norm1.weight', 'blocks.1.norm2.bias', 'blocks.1.norm2.weight', 'blocks.1.mlp.fc1.bias', 'blocks.1.mlp.fc1.weight', 'blocks.1.mlp.fc2.bias', 'blocks.1.mlp.fc2.weight', 'blocks.1.attn.proj.bias', 'blocks.1.attn.proj.weight', 'blocks.1.attn.qkv.bias', 'blocks.1.attn.qkv.weight', 'blocks.10.norm1.bias', 'blocks.10.norm1.weight', 'blocks.10.norm2.bias', 'blocks.10.norm2.weight', 'blocks.10.mlp.fc1.bias', 'blocks.10.mlp.fc1.weight', 'blocks.10.mlp.fc2.bias', 'blocks.10.mlp.fc2.weight', 'blocks.10.attn.proj.bias', 'blocks.10.attn.proj.weight', 'blocks.10.attn.qkv.bias', 'blocks.10.attn.qkv.weight', 'blocks.11.norm1.bias', 'blocks.11.norm1.weight', 'blocks.11.norm2.bias', 'blocks.11.norm2.weight', 'blocks.11.mlp.fc1.bias', 'blocks.11.mlp.fc1.weight', 'blocks.11.mlp.fc2.bias', 'blocks.11.mlp.fc2.weight', 'blocks.11.attn.proj.bias', 'blocks.11.attn.proj.weight', 'blocks.11.attn.qkv.bias', 'blocks.11.attn.qkv.weight', 'blocks.2.norm1.bias', 'blocks.2.norm1.weight', 'blocks.2.norm2.bias', 'blocks.2.norm2.weight', 'blocks.2.mlp.fc1.bias', 'blocks.2.mlp.fc1.weight', 'blocks.2.mlp.fc2.bias', 'blocks.2.mlp.fc2.weight', 'blocks.2.attn.proj.bias', 'blocks.2.attn.proj.weight', 'blocks.2.attn.qkv.bias', 'blocks.2.attn.qkv.weight', 'blocks.3.norm1.bias', 'blocks.3.norm1.weight', 'blocks.3.norm2.bias', 'blocks.3.norm2.weight', 'blocks.3.mlp.fc1.bias', 'blocks.3.mlp.fc1.weight', 'blocks.3.mlp.fc2.bias', 'blocks.3.mlp.fc2.weight', 'blocks.3.attn.proj.bias', 'blocks.3.attn.proj.weight', 'blocks.3.attn.qkv.bias', 'blocks.3.attn.qkv.weight', 'blocks.4.norm1.bias', 'blocks.4.norm1.weight', 'blocks.4.norm2.bias', 'blocks.4.norm2.weight', 'blocks.4.mlp.fc1.bias', 'blocks.4.mlp.fc1.weight', 'blocks.4.mlp.fc2.bias', 'blocks.4.mlp.fc2.weight', 'blocks.4.attn.proj.bias', 'blocks.4.attn.proj.weight', 'blocks.4.attn.qkv.bias', 'blocks.4.attn.qkv.weight', 'blocks.5.norm1.bias', 'blocks.5.norm1.weight', 'blocks.5.norm2.bias', 'blocks.5.norm2.weight', 'blocks.5.mlp.fc1.bias', 'blocks.5.mlp.fc1.weight', 'blocks.5.mlp.fc2.bias', 'blocks.5.mlp.fc2.weight', 'blocks.5.attn.proj.bias', 'blocks.5.attn.proj.weight', 'blocks.5.attn.qkv.bias', 'blocks.5.attn.qkv.weight', 'blocks.6.norm1.bias', 'blocks.6.norm1.weight', 'blocks.6.norm2.bias', 'blocks.6.norm2.weight', 'blocks.6.mlp.fc1.bias', 'blocks.6.mlp.fc1.weight', 'blocks.6.mlp.fc2.bias', 'blocks.6.mlp.fc2.weight', 'blocks.6.attn.proj.bias', 'blocks.6.attn.proj.weight', 'blocks.6.attn.qkv.bias', 'blocks.6.attn.qkv.weight', 'blocks.7.norm1.bias', 'blocks.7.norm1.weight', 'blocks.7.norm2.bias', 'blocks.7.norm2.weight', 'blocks.7.mlp.fc1.bias', 'blocks.7.mlp.fc1.weight', 'blocks.7.mlp.fc2.bias', 'blocks.7.mlp.fc2.weight', 'blocks.7.attn.proj.bias', 'blocks.7.attn.proj.weight', 'blocks.7.attn.qkv.bias', 'blocks.7.attn.qkv.weight', 'blocks.8.norm1.bias', 'blocks.8.norm1.weight', 'blocks.8.norm2.bias', 'blocks.8.norm2.weight', 'blocks.8.mlp.fc1.bias', 'blocks.8.mlp.fc1.weight', 'blocks.8.mlp.fc2.bias', 'blocks.8.mlp.fc2.weight', 'blocks.8.attn.proj.bias', 'blocks.8.attn.proj.weight', 'blocks.8.attn.qkv.bias', 'blocks.8.attn.qkv.weight', 'blocks.9.norm1.bias', 'blocks.9.norm1.weight', 'blocks.9.norm2.bias', 'blocks.9.norm2.weight', 'blocks.9.mlp.fc1.bias', 'blocks.9.mlp.fc1.weight', 'blocks.9.mlp.fc2.bias', 'blocks.9.mlp.fc2.weight', 'blocks.9.attn.proj.bias', 'blocks.9.attn.proj.weight', 'blocks.9.attn.qkv.bias', 'blocks.9.attn.qkv.weight', 'pos_embed', 'patch_embed.proj.bias', 'patch_embed.proj.weight', 'head.bias', 'head.weight'])[2023-08-29 08:58:38] 
[2023-08-29 08:58:38] odict_keys(['cls_token', 'pos_embed_vis', 'pos_embed_inf', 'patch_embed_vis.proj.weight', 'patch_embed_vis.proj.bias', 'patch_embed_inf.proj.weight', 'patch_embed_inf.proj.bias', 'vis_blocks.0.norm1.weight', 'vis_blocks.0.norm1.bias', 'vis_blocks.0.attn.qkv.weight', 'vis_blocks.0.attn.qkv.bias', 'vis_blocks.0.attn.proj.weight', 'vis_blocks.0.attn.proj.bias', 'vis_blocks.0.norm2.weight', 'vis_blocks.0.norm2.bias', 'vis_blocks.0.mlp.fc1.weight', 'vis_blocks.0.mlp.fc1.bias', 'vis_blocks.0.mlp.fc2.weight', 'vis_blocks.0.mlp.fc2.bias', 'vis_blocks.1.norm1.weight', 'vis_blocks.1.norm1.bias', 'vis_blocks.1.attn.qkv.weight', 'vis_blocks.1.attn.qkv.bias', 'vis_blocks.1.attn.proj.weight', 'vis_blocks.1.attn.proj.bias', 'vis_blocks.1.norm2.weight', 'vis_blocks.1.norm2.bias', 'vis_blocks.1.mlp.fc1.weight', 'vis_blocks.1.mlp.fc1.bias', 'vis_blocks.1.mlp.fc2.weight', 'vis_blocks.1.mlp.fc2.bias', 'vis_blocks.2.norm1.weight', 'vis_blocks.2.norm1.bias', 'vis_blocks.2.attn.qkv.weight', 'vis_blocks.2.attn.qkv.bias', 'vis_blocks.2.attn.proj.weight', 'vis_blocks.2.attn.proj.bias', 'vis_blocks.2.norm2.weight', 'vis_blocks.2.norm2.bias', 'vis_blocks.2.mlp.fc1.weight', 'vis_blocks.2.mlp.fc1.bias', 'vis_blocks.2.mlp.fc2.weight', 'vis_blocks.2.mlp.fc2.bias', 'vis_blocks.3.norm1.weight', 'vis_blocks.3.norm1.bias', 'vis_blocks.3.attn.qkv.weight', 'vis_blocks.3.attn.qkv.bias', 'vis_blocks.3.attn.proj.weight', 'vis_blocks.3.attn.proj.bias', 'vis_blocks.3.norm2.weight', 'vis_blocks.3.norm2.bias', 'vis_blocks.3.mlp.fc1.weight', 'vis_blocks.3.mlp.fc1.bias', 'vis_blocks.3.mlp.fc2.weight', 'vis_blocks.3.mlp.fc2.bias', 'inf_blocks.0.norm1.weight', 'inf_blocks.0.norm1.bias', 'inf_blocks.0.attn.qkv.weight', 'inf_blocks.0.attn.qkv.bias', 'inf_blocks.0.attn.proj.weight', 'inf_blocks.0.attn.proj.bias', 'inf_blocks.0.norm2.weight', 'inf_blocks.0.norm2.bias', 'inf_blocks.0.mlp.fc1.weight', 'inf_blocks.0.mlp.fc1.bias', 'inf_blocks.0.mlp.fc2.weight', 'inf_blocks.0.mlp.fc2.bias', 'inf_blocks.1.norm1.weight', 'inf_blocks.1.norm1.bias', 'inf_blocks.1.attn.qkv.weight', 'inf_blocks.1.attn.qkv.bias', 'inf_blocks.1.attn.proj.weight', 'inf_blocks.1.attn.proj.bias', 'inf_blocks.1.norm2.weight', 'inf_blocks.1.norm2.bias', 'inf_blocks.1.mlp.fc1.weight', 'inf_blocks.1.mlp.fc1.bias', 'inf_blocks.1.mlp.fc2.weight', 'inf_blocks.1.mlp.fc2.bias', 'inf_blocks.2.norm1.weight', 'inf_blocks.2.norm1.bias', 'inf_blocks.2.attn.qkv.weight', 'inf_blocks.2.attn.qkv.bias', 'inf_blocks.2.attn.proj.weight', 'inf_blocks.2.attn.proj.bias', 'inf_blocks.2.norm2.weight', 'inf_blocks.2.norm2.bias', 'inf_blocks.2.mlp.fc1.weight', 'inf_blocks.2.mlp.fc1.bias', 'inf_blocks.2.mlp.fc2.weight', 'inf_blocks.2.mlp.fc2.bias', 'inf_blocks.3.norm1.weight', 'inf_blocks.3.norm1.bias', 'inf_blocks.3.attn.qkv.weight', 'inf_blocks.3.attn.qkv.bias', 'inf_blocks.3.attn.proj.weight', 'inf_blocks.3.attn.proj.bias', 'inf_blocks.3.norm2.weight', 'inf_blocks.3.norm2.bias', 'inf_blocks.3.mlp.fc1.weight', 'inf_blocks.3.mlp.fc1.bias', 'inf_blocks.3.mlp.fc2.weight', 'inf_blocks.3.mlp.fc2.bias', 'blocks.0.norm1.weight', 'blocks.0.norm1.bias', 'blocks.0.attn.qkv.weight', 'blocks.0.attn.qkv.bias', 'blocks.0.attn.proj.weight', 'blocks.0.attn.proj.bias', 'blocks.0.norm2.weight', 'blocks.0.norm2.bias', 'blocks.0.mlp.fc1.weight', 'blocks.0.mlp.fc1.bias', 'blocks.0.mlp.fc2.weight', 'blocks.0.mlp.fc2.bias', 'blocks.1.norm1.weight', 'blocks.1.norm1.bias', 'blocks.1.attn.qkv.weight', 'blocks.1.attn.qkv.bias', 'blocks.1.attn.proj.weight', 'blocks.1.attn.proj.bias', 'blocks.1.norm2.weight', 'blocks.1.norm2.bias', 'blocks.1.mlp.fc1.weight', 'blocks.1.mlp.fc1.bias', 'blocks.1.mlp.fc2.weight', 'blocks.1.mlp.fc2.bias', 'blocks.2.norm1.weight', 'blocks.2.norm1.bias', 'blocks.2.attn.qkv.weight', 'blocks.2.attn.qkv.bias', 'blocks.2.attn.proj.weight', 'blocks.2.attn.proj.bias', 'blocks.2.norm2.weight', 'blocks.2.norm2.bias', 'blocks.2.mlp.fc1.weight', 'blocks.2.mlp.fc1.bias', 'blocks.2.mlp.fc2.weight', 'blocks.2.mlp.fc2.bias', 'blocks.3.norm1.weight', 'blocks.3.norm1.bias', 'blocks.3.attn.qkv.weight', 'blocks.3.attn.qkv.bias', 'blocks.3.attn.proj.weight', 'blocks.3.attn.proj.bias', 'blocks.3.norm2.weight', 'blocks.3.norm2.bias', 'blocks.3.mlp.fc1.weight', 'blocks.3.mlp.fc1.bias', 'blocks.3.mlp.fc2.weight', 'blocks.3.mlp.fc2.bias', 'blocks.4.norm1.weight', 'blocks.4.norm1.bias', 'blocks.4.attn.qkv.weight', 'blocks.4.attn.qkv.bias', 'blocks.4.attn.proj.weight', 'blocks.4.attn.proj.bias', 'blocks.4.norm2.weight', 'blocks.4.norm2.bias', 'blocks.4.mlp.fc1.weight', 'blocks.4.mlp.fc1.bias', 'blocks.4.mlp.fc2.weight', 'blocks.4.mlp.fc2.bias', 'blocks.5.norm1.weight', 'blocks.5.norm1.bias', 'blocks.5.attn.qkv.weight', 'blocks.5.attn.qkv.bias', 'blocks.5.attn.proj.weight', 'blocks.5.attn.proj.bias', 'blocks.5.norm2.weight', 'blocks.5.norm2.bias', 'blocks.5.mlp.fc1.weight', 'blocks.5.mlp.fc1.bias', 'blocks.5.mlp.fc2.weight', 'blocks.5.mlp.fc2.bias', 'blocks.6.norm1.weight', 'blocks.6.norm1.bias', 'blocks.6.attn.qkv.weight', 'blocks.6.attn.qkv.bias', 'blocks.6.attn.proj.weight', 'blocks.6.attn.proj.bias', 'blocks.6.norm2.weight', 'blocks.6.norm2.bias', 'blocks.6.mlp.fc1.weight', 'blocks.6.mlp.fc1.bias', 'blocks.6.mlp.fc2.weight', 'blocks.6.mlp.fc2.bias', 'blocks.7.norm1.weight', 'blocks.7.norm1.bias', 'blocks.7.attn.qkv.weight', 'blocks.7.attn.qkv.bias', 'blocks.7.attn.proj.weight', 'blocks.7.attn.proj.bias', 'blocks.7.norm2.weight', 'blocks.7.norm2.bias', 'blocks.7.mlp.fc1.weight', 'blocks.7.mlp.fc1.bias', 'blocks.7.mlp.fc2.weight', 'blocks.7.mlp.fc2.bias', 'norm.weight', 'norm.bias', 'bottleneck.weight', 'bottleneck.bias', 'bottleneck.running_mean', 'bottleneck.running_var', 'bottleneck.num_batches_tracked', 'classifier.weight'])[2023-08-29 08:58:38] 
[2023-08-29 08:58:45] ==> Start Training...[2023-08-29 08:58:45] 
[2023-08-29 08:58:45] ==> Preparing Data Loader...[2023-08-29 08:58:45] 
[2023-08-29 08:58:45] 0[2023-08-29 08:58:45] 
[2023-08-29 08:58:45] [8094 8142 8180 ...  359  368  362][2023-08-29 08:58:45] 
[2023-08-29 08:58:45] [6692 6693 6677 ...  190  196  201][2023-08-29 08:58:45] 
[2023-08-29 08:58:47] Epoch: [0][0/706] Loss:13.333 iLoss:6.570 TLoss:6.764 [2023-08-29 08:58:47] 
[2023-08-29 08:59:06] Epoch: [0][50/706] Loss:11.944 iLoss:6.520 TLoss:5.424 [2023-08-29 08:59:06] 
